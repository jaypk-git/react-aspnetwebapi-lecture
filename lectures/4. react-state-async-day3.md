# React 3ì¼ì°¨: ìƒíƒœ ê´€ë¦¬ì™€ ë¹„ë™ê¸° ì²˜ë¦¬

# React Query

React QueryëŠ” ì„œë²„ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ë°ì´í„° fetching, ìºì‹±, ë™ê¸°í™”, ì—…ë°ì´íŠ¸ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

## 1. React Query ì„¤ì •

ë¨¼ì € React Queryë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤:

```bash
npm install @tanstack/react-query
# ë˜ëŠ”
pnpm add @tanstack/react-query
```

ê·¸ë¦¬ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì— React Queryë¥¼ ì„¤ì •í•©ë‹ˆë‹¤:

```jsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'

const queryClient = new QueryClient()

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      {/* ì—¬ê¸°ì— ì• í”Œë¦¬ì¼€ì´ì…˜ ì»´í¬ë„ŒíŠ¸ë“¤ */}
    </QueryClientProvider>
  )
}
```

## 2. useQuery í›…

`useQuery` í›…ì€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤:

```jsx
import { useQuery } from '@tanstack/react-query'

function Example() {
  const { isLoading, error, data } = useQuery({
    queryKey: ['repoData'],
    queryFn: () =>
      fetch('https://api.github.com/repos/tannerlinsley/react-query').then(
        (res) => res.json(),
      ),
  })

  if (isLoading) return 'Loading...'

  if (error) return 'An error has occurred: ' + error.message

  return (
    <div>
      <h1>{data.name}</h1>
      <p>{data.description}</p>
      <strong>ğŸ‘€ {data.subscribers_count}</strong>{' '}
      <strong>âœ¨ {data.stargazers_count}</strong>{' '}
      <strong>ğŸ´ {data.forks_count}</strong>
    </div>
  )
}
```

## 3. useMutation í›…

`useMutation` í›…ì€ ë°ì´í„°ë¥¼ ìƒì„±/ìˆ˜ì •/ì‚­ì œí•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤:

```jsx
import { useMutation } from '@tanstack/react-query'

function Example() {
  const mutation = useMutation({
    mutationFn: (newTodo) => {
      return fetch('/api/todo', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newTodo),
      }).then(res => res.json())
    },
  })

  return (
    <div>
      {mutation.isLoading ? (
        'Adding todo...'
      ) : (
        <>
          {mutation.isError ? (
            <div>An error occurred: {mutation.error.message}</div>
          ) : null}

          {mutation.isSuccess ? <div>Todo added!</div> : null}

          <button
            onClick={() => {
              mutation.mutate({ id: new Date(), title: 'Do Laundry' })
            }}
          >
            Create Todo
          </button>
        </>
      )}
    </div>
  )
}
```

## 4. ì¿¼ë¦¬ ë¬´íš¨í™”

ë°ì´í„°ê°€ stale ë˜ì—ˆì„ ë•Œ ì¿¼ë¦¬ë¥¼ ë¬´íš¨í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```jsx
import { useQueryClient } from '@tanstack/react-query'

const queryClient = useQueryClient()

queryClient.invalidateQueries({ queryKey: ['todos'] })
```

## 5. ì¿¼ë¦¬ í”„ë¦¬í˜ì¹­

ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í•˜ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```jsx
const prefetchTodos = async () => {
  await queryClient.prefetchQuery({
    queryKey: ['todos'],
    queryFn: fetchTodos,
  })
}
```

## 6. Query Keys

Query KeyëŠ” ì¿¼ë¦¬ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤:

```jsx
// ë¬¸ìì—´ í‚¤
useQuery({ queryKey: ['todos'], ... })

// ë°°ì—´ í‚¤
useQuery({ queryKey: ['todo', 5], ... })

// ê°ì²´ë¥¼ í¬í•¨í•œ ë°°ì—´ í‚¤
useQuery({ queryKey: ['todos', { status, page }], ... })
```

# React Router

## 1. React Router ì†Œê°œ

React RouterëŠ” React ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë¼ìš°íŒ…ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë‹¨ì¼ í˜ì´ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜(SPA)ì—ì„œ ì—¬ëŸ¬ "í˜ì´ì§€"ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•:
- ì„ ì–¸ì  ë¼ìš°íŒ…
- ë™ì  ë¼ìš°íŠ¸ ë§¤ì¹­
- ì¤‘ì²© ë¼ìš°íŒ… ì§€ì›
- íˆìŠ¤í† ë¦¬ ê´€ë¦¬

### ì„¤ì¹˜:
```bash
npm install react-router-dom
```

## 2. ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸

### BrowserRouter
HTML5 history APIë¥¼ ì‚¬ìš©í•˜ì—¬ UIë¥¼ URLê³¼ ë™ê¸°í™”í•©ë‹ˆë‹¤.

```jsx
import { BrowserRouter } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      {/* ë¼ìš°íŠ¸ ì •ì˜ */}
    </BrowserRouter>
  );
}
```

### Route
URLê³¼ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§¤í•‘í•©ë‹ˆë‹¤.

```jsx
import { Route } from 'react-router-dom';

<Route path="/about" component={About} />
```

### Link
ì„ ì–¸ì ì´ê³  ì ‘ê·¼ì„±ì´ ìˆëŠ” ë„¤ë¹„ê²Œì´ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.

```jsx
import { Link } from 'react-router-dom';

<Link to="/about">About</Link>
```

### Switch
ë§¤ì¹­ë˜ëŠ” ì²« ë²ˆì§¸ ë¼ìš°íŠ¸ë§Œ ë Œë”ë§í•©ë‹ˆë‹¤.

```jsx
import { Switch, Route } from 'react-router-dom';

<Switch>
  <Route exact path="/" component={Home} />
  <Route path="/about" component={About} />
  <Route path="*" component={NotFound} />
</Switch>
```

## 3. ë™ì  ë¼ìš°íŒ…

URL íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì  ë¼ìš°íŒ…ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
<Route path="/users/:id" component={User} />
```

useParams í›…ì„ ì‚¬ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„°ì— ì ‘ê·¼:

```jsx
import { useParams } from 'react-router-dom';

function User() {
  let { id } = useParams();
  return <div>User ID: {id}</div>;
}
```

## 4. í”„ë¡œê·¸ë˜ë§¤í‹± ë„¤ë¹„ê²Œì´ì…˜

useHistory í›…ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ë„¤ë¹„ê²Œì´ì…˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
import { useHistory } from 'react-router-dom';

function HomeButton() {
  let history = useHistory();

  function handleClick() {
    history.push('/home');
  }

  return (
    <button type="button" onClick={handleClick}>
      Go home
    </button>
  );
}
```

## 5. ì¸ì¦ ë¼ìš°íŒ…

ì¸ì¦ì´ í•„ìš”í•œ ë¼ìš°íŠ¸ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ ì»¤ìŠ¤í…€ Route ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
function PrivateRoute({ component: Component, ...rest }) {
  return (
    <Route
      {...rest}
      render={props =>
        isAuthenticated ? (
          <Component {...props} />
        ) : (
          <Redirect to="/login" />
        )
      }
    />
  );
}

// ì‚¬ìš©
<PrivateRoute path="/dashboard" component={Dashboard} />
```

## 7. ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì²˜ë¦¬

useLocation í›…ì„ ì‚¬ìš©í•˜ì—¬ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```jsx
import { useLocation } from 'react-router-dom';

function useQuery() {
  return new URLSearchParams(useLocation().search);
}

function SearchResults() {
  let query = useQuery();
  return <div>Search results for: {query.get('q')}</div>;
}
```

## 8. ì „ì²´ ì˜ˆì œ

```jsx
import React from 'react';
import {
  BrowserRouter as Router,
  Switch,
  Route,
  Link,
  useParams,
  useRouteMatch,
  useHistory,
  useLocation
} from 'react-router-dom';

// Home ì»´í¬ë„ŒíŠ¸
const Home = () => <h2>Home Page</h2>;

// About ì»´í¬ë„ŒíŠ¸
const About = () => <h2>About Page</h2>;

// User ì»´í¬ë„ŒíŠ¸ (ë™ì  ë¼ìš°íŒ… ì˜ˆì‹œ)
const User = () => {
  let { id } = useParams();
  return <h2>User: {id}</h2>;
};

// Users ì»´í¬ë„ŒíŠ¸ (ì¤‘ì²© ë¼ìš°íŒ… ì˜ˆì‹œ)
const Users = () => {
  let { path, url } = useRouteMatch();
  return (
    <div>
      <h2>Users</h2>
      <ul>
        <li>
          <Link to={`${url}/1`}>User 1</Link>
        </li>
        <li>
          <Link to={`${url}/2`}>User 2</Link>
        </li>
      </ul>

      <Switch>
        <Route exact path={path}>
          <h3>Please select a user.</h3>
        </Route>
        <Route path={`${path}/:userId`}>
          <User />
        </Route>
      </Switch>
    </div>
  );
};

// SearchResults ì»´í¬ë„ŒíŠ¸ (ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì²˜ë¦¬ ì˜ˆì‹œ)
const SearchResults = () => {
  let query = new URLSearchParams(useLocation().search);
  return <h2>Search results for: {query.get('q')}</h2>;
};

// ë©”ì¸ App ì»´í¬ë„ŒíŠ¸
function App() {
  let history = useHistory();

  return (
    <Router>
      <div>
        <nav>
          <ul>
            <li><Link to="/">Home</Link></li>
            <li><Link to="/about">About</Link></li>
            <li><Link to="/users">Users</Link></li>
            <li><Link to="/search?q=react">Search</Link></li>
          </ul>
        </nav>

        <button onClick={() => history.push('/about')}>Go to About</button>

        <Switch>
          <Route path="/" exact component={Home} />
          <Route path="/about" component={About} />
          <Route path="/users" component={Users} />
          <Route path="/search" component={SearchResults} />
        </Switch>
      </div>
    </Router>
  );
}

export default App;
```


## ì‹¤ìŠµ ê³¼ì œ

1. ìœ„ì˜ ì˜ˆì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ í˜ì´ì§€ (ì˜ˆ: Contact)ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.
2. ì‚¬ìš©ì ëª©ë¡ í˜ì´ì§€ë¥¼ ë§Œë“¤ê³ , ê° ì‚¬ìš©ìì˜ ìƒì„¸ ì •ë³´ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ë§í¬ë¥¼ êµ¬í˜„í•´ë³´ì„¸ìš”.
3. 404 Not Found í˜ì´ì§€ë¥¼ ë§Œë“¤ê³ , ì •ì˜ë˜ì§€ ì•Šì€ ë¼ìš°íŠ¸ì— ëŒ€í•´ ì´ í˜ì´ì§€ê°€ í‘œì‹œë˜ë„ë¡ êµ¬í˜„í•´ë³´ì„¸ìš”.


